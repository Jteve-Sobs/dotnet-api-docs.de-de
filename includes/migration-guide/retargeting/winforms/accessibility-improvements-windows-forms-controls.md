### <a name="accessibility-improvements-in-windows-forms-controls"></a>Verbesserung der Barrierefreiheit von Windows Forms-Steuerelementen

|   |   |
|---|---|
|Details|Die Arbeitsweise von Windows Forms mit Technologien für die Barrierefreiheit wird verbessert, um die Kunden von Windows Forms besser zu unterstützen. Dazu zählen die folgenden Änderungen:<ul><li>Änderungen zum Verbessern der Anzeige während des Modus mit hohem Kontrast</li><li>Änderungen zum Verbessern der Benutzerfreundlichkeit des Eigenschaftenbrowsers Folgende Verbesserungen wurden am Eigenschaftenbrowser vorgenommen:</li><li>Eine verbesserte Tastaturnavigation durch die verschiedenen Fenster der Dropdownauswahl</li><li>Unnötige Tabstopps wurden reduziert.</li><li>Eine verbesserte Berichterstellung der Steuerelementtypen</li><li>Ein verbessertes Verhalten der Sprachausgabe</li><li>Änderungen an der Implementierung fehlender Barrierefreiheitsmuster für die Benutzeroberfläche in Steuerelementen</li></ul>|
|Vorschlag|<strong>Aktivieren oder Deaktivieren dieser Änderungen</strong> Damit die Anwendung von diesen Änderungen profitieren kann, muss sie auf .NET Framework 4.7.1 oder höher ausgeführt werden. Die Anwendung kann von diesen Änderungen profitieren, wenn Sie Folgendes durchführen:<ul><li>Kompilieren Sie diese erneut, um .NET Framework 4.7.1 anzuzielen. Diese Änderungen der Barrierefreiheit werden standardmäßig für WPF-Anwendungen aktiviert, die .NET Framework 4.7.1 oder höher anzielen.</li><li>Veraltete Verhaltensweisen der Barrierefreiheit werden deaktiviert, indem wie im folgenden Beispiel dargestellt folgendes [AppContext-Element](~/docs/framework/configure-apps/file-schema/runtime/appcontextswitchoverrides-element.md) zum <code>&lt;runtime&gt;</code>-Abschnitt der app.config-Datei hinzugefügt und auf <code>false</code> festgelegt wird.</li></ul><pre><code class="language-xml">&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;&#13;&#10;&lt;configuration&gt;&#13;&#10;&lt;startup&gt;&#13;&#10;&lt;supportedRuntime version=&quot;v4.0&quot; sku=&quot;.NETFramework,Version=v4.7&quot;/&gt;&#13;&#10;&lt;/startup&gt;&#13;&#10;&lt;runtime&gt;&#13;&#10;&lt;!-- AppContextSwitchOverrides value attribute is in the form of &#39;key1=true/false;key2=true/false  --&gt;&#13;&#10;&lt;AppContextSwitchOverrides value=&quot;Switch.UseLegacyAccessibilityFeatures=false&quot; /&gt;&#13;&#10;&lt;/runtime&gt;&#13;&#10;&lt;/configuration&gt;&#13;&#10;</code></pre>Bei Anwendungen, die .NET Framework 4.7.1 oder höher anzielen und die veralteten Verhaltensweisen für die Barrierefreiheit beibehalten sollen, können Sie die Verwendung des veralteten Features für die Barrierefreiheit aktivieren, indem Sie das AppContext-Element auf <code>true</code> festlegen. Eine Übersicht über die Automatisierung der Benutzeroberfläche finden Sie unter [UI Automation Overview (Übersicht über die Automatisierung der Benutzeroberfläche)](~/docs/framework/ui-automation/ui-automation-overview.md). <strong>Hinzugefügte Unterstützung für Muster und Eigenschaften für die Automatisierung der Benutzeroberfläche</strong> Clients für die Barrierefreiheit können die neuen WinForms-Funktionen für die Barrierefreiheit nutzen, indem allgemeine, öffentlich beschriebene Aufrufmuster verwendet werden. Diese Muster sind nicht für WinForms spezifisch. Clients für die Barrierefreiheit können beispielsweise die QueryInterface-Methode der IAccessible-Schnittstelle (MAAS) aufrufen, um eine IServiceProvider-Schnittstelle abzurufen. Wenn diese Schnittstelle verfügbar ist, können Clients die QueryService-Methode verwenden, um eine IAccessibleEx-Schnittstelle anzufordern. Weitere Informationen finden Sie unter [Using IAccessibleEx from a Client (Verwenden von IAccessibleEx über einen Client)](https://msdn.microsoft.com/library/windows/desktop/dd561924.aspx). Ab .NET Framework 4.7.1 sind „IServiceProvider“ und [IAccessibleEx](https://msdn.microsoft.com/library/windows/desktop/dd561898.aspx) gegebenenfalls für WinForms-Objekte für die Barrierefreiheit verfügbar. .NET Framework 4.7.1 fügt die Unterstützung für folgende Muster und Eigenschaften für die Automatisierung der Benutzeroberfläche hinzu:<ul><li>Die Steuerelemente <code>T:System.Windows.Forms.ToolStripSplitButton</code> und <code>T:System.Windows.Forms.ComboBox</code> unterstützen das Muster [Erweitern/Reduzieren](~/docs/framework/ui-automation/implementing-the-ui-automation-expandcollapse-control-pattern.md).</li><li>Das <code>T:System.Windows.Forms.ToolStripMenuItem</code>-Steuerelement weist einen [ControlType](~/docs/framework/ui-automation/ui-automation-support-for-the-menubar-control-type.md)-Eigenschaftswert von <xref:System.Windows.Automation.ControlType.MenuItem?displayProperty=nameWithType> auf.</li><li>Das <code>T:System.Windows.Forms.ToolStripItem</code>-Steuerelement unterstützt die [Name](xref:System.Windows.Automation.AutomationElement.NameProperty)-Eigenschaft und das Muster [Erweitern/Reduzieren](~/docs/framework/ui-automation/implementing-the-ui-automation-expandcollapse-control-pattern.md).</li><li>Das <code>T:System.Windows.Forms.ToolStripDropDownItem</code>-Steuerelement unterstützt das <xref:System.Windows.Forms.AccessibleEvents>-Element, das StateChange und NameChange angibt, wenn das Dropdownmenü erweitert oder reduziert ist.</li><li>Das <code>T:System.Windows.Forms.ToolStripDropDownButton</code>-Steuerelement weist einen [ControlType](~/docs/framework/ui-automation/ui-automation-support-for-the-menubar-control-type.md)-Eigenschaftswert von <xref:System.Windows.Automation.ControlType.MenuItem?displayProperty=nameWithType> auf.</li><li>Das <code>T:System.Windows.Forms.DataGridViewCheckBoxCell</code>-Steuerelement unterstützt das [Umschaltmuster](xref:System.Windows.Automation.TogglePattern).</li><li>Die Steuerelemente <code>T:System.Windows.Forms.NumericUpDown</code> und <code>T:System.Windows.Forms.DomainUpDown</code> unterstützen das [Name](xref:System.Windows.Automation.AutomationElement.NameProperty)-Element und weisen eine [ControlType](~/docs/framework/ui-automation/ui-automation-support-for-the-spinner-control-type.md)-Eigenschaft von <xref:System.Windows.Automation.ControlType.Spinner?displayProperty=nameWithType> auf.</li></ul><strong>Verbesserungen am PropertyGrid-Steuerelement</strong> Mit .NET Framework 4.7.1 werden folgende Verbesserungen zum PropertyBrowser-Steuerelement hinzugefügt:<ul><li>Die Schaltfläche <strong>Details</strong> im Dialogfeld „Fehler“, das angezeigt wird, wenn der Benutzer einen falschen Wert in das <code>T:System.Windows.Forms.PropertyGrid</code>-Steuerelement eingibt, unterstützt das Muster [Erweitern/Reduzieren](~/docs/framework/ui-automation/implementing-the-ui-automation-expandcollapse-control-pattern.md), Benachrichtigungen für Status- und Namensänderungen und eine [ControlType](~/docs/framework/ui-automation/ui-automation-support-for-the-menubar-control-type.md)-Eigenschaft mit einem Wert von <xref:System.Windows.Automation.ControlType.MenuItem?displayProperty=nameWithType>.</li><li>Auf den Bereich „Meldung“, der angezeigt wird, wenn die Schaltfläche <strong>Details</strong> des Dialogfelds „Fehler“ erweitert ist, kann nun über die Tastatur zugegriffen werden. Außerdem kann die Microsoft-Sprachausgabe den Inhalt der Fehlermeldung ausgeben.</li><li>Das <xref:System.Windows.Forms.AccessibleRole>-Element der Zeilen im <code>T:System.Windows.Forms.PropertyGrid</code>-Steuerelement wurde von &quot;Zeile&quot; in &quot;Zelle&quot; geändert. Die Zelle wird dem UIA-ControlType-Element &quot;DataItem&quot; zugeordnet, wodurch entsprechende Tastenkombinationen und Microsoft-Sprachausgaben unterstützt werden.</li><li>Die Zeilen des <code>T:System.Windows.Forms.PropertyGrid</code>-Steuerelement, die Headerelemente darstellen, wenn die <code>P:System.Windows.Forms.PropertySort</code>-Eigenschaft des <code>T:System.Windows.Forms.PropertyGrid</code>-Steuerelements auf <code>F:System.Windows.Forms.PropertySory.Categorized</code> festgelegt ist, weisen einen [ControlType](~/docs/framework/ui-automation/ui-automation-support-for-the-menubar-control-type.md)-Eigenschaftswert von <xref:System.Windows.Automation.ControlType.Button?displayProperty=nameWithType> auf.</li><li>Die Zeilen des <code>T:System.Windows.Forms.PropertyGrid</code>-Steuerelement, die Headerelemente darstellen, wenn die <code>P:System.Windows.Forms.PropertySort</code>-Eigenschaft des <code>T:System.Windows.Forms.PropertyGrid</code>-Steuerelements auf <code>F:System.Windows.Forms.PropertySory.Categorized</code> festgelegt ist, unterstützen das Muster [Erweitern/Reduzieren](~/docs/framework/ui-automation/implementing-the-ui-automation-expandcollapse-control-pattern.md).</li><li>Verbesserte Tastaturnavigation zwischen dem Raster und der darüber liegenden Symbolleiste. Durch das Drücken von &quot;UMSCHALTTASTE+TAB-TASTE&quot; wird nun die erste Schaltfläche der Symbolleiste statt der gesamten Symbolleiste ausgewählt.</li><li>Bei den <code>T:System.Windows.Forms.PropertyGrid</code>-Steuerelementen, die im Modus mit hohem Kontrast angezeigt werden, wird nun ein Fokusrechteck um die Schaltfläche des Steuerelements angezeigt, die dem aktuellen Wert der <code>P:System.Windows.Forms.PropertySort</code>-Eigenschaft entspricht.</li><li>Bei <code>T:System.Windows.Forms.PropertyGrid</code>-Steuerelementen, die im Modus mit hohem Kontrast angezeigt werden, und bei denen eine <code>P:System.Windows.Forms.PropertySort</code>-Eigenschaft auf <code>F:System.Windows.Forms.PropertySory.Categorized</code> festgelegt ist, wird nun der Hintergrund von Kategorieheadern in kontrastreicher Farbe angezeigt.</li><li>Bei <code>T:System.Windows.Forms.PropertyGrid</code>-Steuerelementen wird besser zwischen den Elementen der Symbolleiste mit Fokus und denen, die den aktuellen Wert der <code>P:System.Windows.Forms.PropertySort</code>-Eigenschaft angeben, unterschieden. Dieser Fehlerbehebung besteht aus einer Änderung für Szenarios mit und ohne hohen Kontrast.</li><li>Symbolleistenelemente des <code>T:System.Windows.Forms.PropertyGrid</code>-Steuerelements, die den aktuellen Wert der <code>P:System.Windows.Forms.PropertySort</code>-Eigenschaft angeben, unterstützen das [Umschaltmuster](xref:System.Windows.Automation.TogglePattern).</li><li>Verbesserte Unterstützung der Unterscheidung der ausgewählten Ausrichtung in der Ausrichtungsauswahl durch die Microsoft-Sprachausgabe.</li><li>Wenn ein leeres <code>T:System.Windows.Forms.PropertyGrid</code>-Steuerelement in einem Formular angezeigt wird, wird dieses nun fokussiert. Dies war zuvor nicht der Fall.</li></ul><strong>Verwendung von durch das Betriebssystem definierten Farben in Designs mit hohem Kontrast</strong><ul><li>Bei <code>T:System.Windows.Forms.Button</code>- und <code>T:System.Windows.Forms.CheckBox</code>-Steuerelementen, bei denen <code>P:System.Windows.Forms.Control.FlatStyle</code> auf <xref:System.Windows.Forms.FlatStyle.System?displayProperty=nameWithType> (Standardformat) festgelegt ist, verwenden nun die vom Betriebssystem definierten Farben im Design mit hohem Kontrast, wenn dieses ausgewählt ist. Zuvor gab es keinen Kontrast zwischen Text und Hintergrundfarbe, wodurch der Text schwer lesbar war.</li><li>Die Elemente <code>T:System.Windows.Forms.Button</code>, <code>T:System.Windows.Forms.CheckBox</code>, <code>T:System.Windows.Forms.RadioButton</code>, <code>T:System.Windows.Forms.Label</code>, <code>T:System.Windows.Forms.LinkLabel</code> und <code>T:System.Windows.Forms.GroupBox</code>, bei denen <code>P:System.Windows.Forms.Control.Enabled</code> auf <em>FALSE</em> festgelegt ist, verwendeten schattierte Farben zum Rendern von Text in Designs mit hohem Kontrast. Dies führt zu geringem Kontrast mit dem Hintergrund. Diese Steuerelemente verwenden nun die vom Betriebssystem definierte Farbe für &quot;gesperrten Text&quot;. Diese Fehlerbehebung gilt für Steuerelemente, bei denen die <code>P:System.Windows.Forms.Control.FlatStyle</code>-Eigenschaft auf einen anderen Wert als <code>F:System.Windows.Forms.FlatStyle.System</code> festgelegt ist. Die zuletzt aufgeführten Steuerelemente werden vom Betriebssystem gerendert.</li><li><code>T:System.Windows.Forms.DataGridView</code> rendert nun ein sichtbares Rechteck um den Inhalt der Zelle, die derzeit fokussiert wird. Zuvor wurde dieses in bestimmten Designs mit hohem Kontrast nicht angezeigt.</li><li><code>T:System.Windows.Forms.ToolStripMenuItem</code>-Steuerelemente, bei denen die <code>P:System.Windows.Forms.ToolStripItem.Enabled</code>-Eigenschaft auf <em>FALSE</em> festgelegt ist, verwenden nun die vom Betriebssystem definierte Farbe für &quot;gesperrten Text&quot;.</li><li><code>T:System.Windows.Forms.ToolStripMenuItem</code>-Steuerelemente, bei denen die <code>P:System.Windows.Forms.ToolStripItem.Checked</code>-Eigenschaft auf <em>TRUE</em> festgelegt ist, rendern nun das zugeordnete Häkchen in einer kontrastreichen Systemfarbe.  Zuvor war die Farbe des Häkchens nicht kontrastreich genug, weshalb es in Designs mit hohem Kontrast nicht sichtbar war.</li></ul>Hinweis: In Windows 10 wurden die Werte für einige Systemfarben mit hohem Kontrast geändert. Das Windows Forms-Framework basiert auf dem Win32-Framework. Führen Sie für die besten Ergebnisse die aktuelle Version von Windows aus, und aktivieren Sie die neuesten Änderungen am Betriebssystem, indem Sie eine app.manifest-Datei zu einer Testanwendung hinzufügen und den Kommentar aus folgendem Code entfernen:<pre><code>&lt;!-- Windows 10 --&gt;&#13;&#10;&lt;supportedOS Id=&quot;{8e0f7a12-bfb3-4fe8-b9a5-48fd50a15a9a}&quot; /&gt;&#13;&#10;</code></pre><strong>Verbesserte Tastaturnavigation</strong><ul><li>Wenn ein <code>T:System.Windows.Forms.ComboBox</code>-Steuerelement eine <code>P:System.Windows.Forms.ComboBox.DropDownStyle</code>-Eigenschaft aufweist, die auf <code>F:System.Windows.Forms.DropDownStyle.DropDownList</code> festgelegt ist und das erste Steuerelement in der Aktivierreihenfolge des Formulars ist, zeigt dieses nun ein Fokusrechteck an, wenn das übergeordnete Formular mithilfe der Tastatur geöffnet wird. Vor dieser Änderung lag der Tastaturfokus auf diesem Steuerelement, es wurde jedoch kein Fokusindikator gerendert.</li></ul><strong>Verbesserte Unterstützung für die Sprachausgabe</strong><ul><li>Dem <code>T:System.Windows.Forms.MonthCalendar</code>-Steuerelement wurde die Unterstützung für Hilfstechnologien hinzugefügt, damit diese auf das Steuerelement zugreifen können. Dazu zählt auch die Funktion der Microsoft-Sprachausgabe, den Wert des Steuerelements auszugeben. Dies war zuvor nicht möglich.</li><li>Das <code>T:System.Windows.Forms.CheckedListBox</code>-Steuerelement benachrichtigt die Microsoft-Sprachausgabe nun, wenn die <code>P:System.Windows.Forms.CheckState</code>-Eigenschaft geändert wurde. Zuvor erhielt die Microsoft-Sprachausgabe keine Benachrichtigung, deshalb wurden die Benutzer nicht informiert, wenn die <code>P:System.Windows.Forms.CheckState</code>-Eigenschaft aktualisiert wurde.</li><li>Die Art, wie das <code>T:System.Windows.Forms.LinkLabel</code>-Steuerelement die Microsoft-Sprachausgabe über den Text des Steuerelements benachrichtigt, wurde geändert. Zuvor hat die Microsoft-Sprachausgabe diesen Text zweimal und die Symbole &quot;&amp;&quot; als Text ausgegeben, obwohl diese für den Benutzer nicht sichtbar sind. Der doppelten Text sowie die unnötigen &quot;&amp;&quot;-Symbole wurden aus den Ausgaben der Microsoft-Sprachausgabe entfernt.</li><li>Die <code>T:System.Windows.Forms.DataGridViewCell</code>-Steuerelementtypen melden den schreibgeschützten Status nun ordnungsgemäß an die Microsoft-Sprachausgabe und andere Hilfstechnologien.</li><li>Die Microsoft-Sprachausgabe kann nun das Systemmenü von untergeordneten Fenstern in Anwendungen mit einer [Schnittstelle für mehrere Dokumente](~/docs/framework/winforms/advanced/multiple-document-interface-mdi-applications.md) ausgeben.</li><li>Die Microsoft-Sprachausgabe kann nun <code>T:System.Windows.Forms.ToolStripMenuItem</code>-Steuerelemente ausgeben, bei der die <code>P:System.Windows.Forms.ToolStripItem.Enabled</code>-Eigenschaft auf <em>FALSE</em> festgelegt ist. Zuvor konnte die Microsoft-Sprachausgabe keine deaktivierten Menüelemente fokussieren, um deren Inhalt auszugeben.</li></ul>|
|Bereich|Hauptversion|
|Version|4.7.1|
|Typ|Neuzuweisung|
|Betroffene APIs|<ul><li><xref:System.Windows.Forms.ToolStripDropDownButton.CreateAccessibilityInstance?displayProperty=nameWithType></li><li><xref:System.Windows.Forms.DomainUpDown.DomainUpDownAccessibleObject.Name?displayProperty=nameWithType></li><li>[MonthCalendar.AccessibilityObject](xref:System.Windows.Forms.Control.AccessibilityObject)</li></ul>|

