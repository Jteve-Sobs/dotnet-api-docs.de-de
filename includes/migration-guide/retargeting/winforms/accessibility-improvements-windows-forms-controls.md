### <a name="accessibility-improvements-in-windows-forms-controls"></a>Barrierefreiheit-Verbesserungen in Windows Forms-Steuerelementen

|   |   |
|---|---|
|Details|Windows Forms ist Eingabehilfen-Technologien, um besser zu unterstützen Windows Forms-Kunden die Zusammenarbeit mit verbessern. Dazu gehören die folgenden Änderungen:<ul><li>Änderungen zur Verbesserung, die während des Modus für hohe Kontraste angezeigt werden.</li><li>Änderungen zur Verbesserung der Eigenschaftenbrowser auftreten. Eigenschaft Browser Verbesserungen gehören:</li><li>Eine verbesserte Tastaturnavigation durch die verschiedenen Fenster der Dropdownauswahl</li><li>Reduziert unnötige Tabstopps.</li><li>Eine verbesserte Berichterstellung der Steuerelementtypen</li><li>Ein verbessertes Verhalten der Sprachausgabe</li><li>Änderungen an der fehlenden UI Eingabehilfen Muster in Steuerelementen zu implementieren.</li></ul>|
|Vorschlag|<strong>Wie Sie diese Änderungen Einverständnis im</strong>In der Reihenfolge für die Anwendung diese Änderungen profitieren, muss es auf .NET Framework 4.7.1 ausgeführt oder höher. Die Anwendung kann diese Änderungen in einer der folgenden Methoden nutzen:<ul><li>Es wird neu kompiliert, die .NET Framework 4.7.1. Diese Eingabehilfen-Änderungen werden standardmäßig in Windows Forms-Anwendungen, die das .NET 4.7.1 Framework aktiviert oder höher.</li><li>Es durch das Hinzufügen der folgenden Out die ältere Eingabehilfen Verhaltensweisen opts [AppContext Switch](~/docs/framework/configure-apps/file-schema/runtime/appcontextswitchoverrides-element.md) auf die <code>&lt;runtime&gt;</code> Abschnitt der Datei "App.config" und Festlegen des Werts auf <code>false</code>, wie das folgende Beispiel zeigt.</li></ul><pre><code class="language-xml">&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;&#13;&#10;&lt;configuration&gt;&#13;&#10;&lt;startup&gt;&#13;&#10;&lt;supportedRuntime version=&quot;v4.0&quot; sku=&quot;.NETFramework,Version=v4.7&quot;/&gt;&#13;&#10;&lt;/startup&gt;&#13;&#10;&lt;runtime&gt;&#13;&#10;&lt;!-- AppContextSwitchOverrides value attribute is in the form of &#39;key1=true/false;key2=true/false  --&gt;&#13;&#10;&lt;AppContextSwitchOverrides value=&quot;Switch.UseLegacyAccessibilityFeatures=false&quot; /&gt;&#13;&#10;&lt;/runtime&gt;&#13;&#10;&lt;/configuration&gt;&#13;&#10;</code></pre>Anwendungen, die das .NET 4.7.1 Framework oder höher und die Vorgängerversion beibehalten möchten Eingabehilfen Verhalten können Sie dies für die Verwendung von älteren Barrierefreiheitsfunktionen durch explizites Festlegen dieser Option AppContext auf <code>true</code>. Einen Überblick über die UI-Automatisierung finden Sie unter der [Übersicht über die Benutzeroberflächenautomatisierung](~/docs/framework/ui-automation/ui-automation-overview.md). <strong>Zusätzliche Unterstützung für Benutzeroberflächenautomatisierungs-Muster und Eigenschaften</strong>barrierefreiheitsclients profitieren von neuen WinForms-Barrierefreiheitsfunktionen durch Aufruf von allgemeinen, öffentlich beschriebene Muster verwenden. Diese Muster sind nicht WinForms-spezifisch. Beispielsweise können barrierefreiheitsclients QueryInterface-Methode für die IAccessible-Schnittstelle (MAAS) beim Abrufen einer IServiceProvider-Schnittstelle aufrufen. Wenn diese Schnittstelle verfügbar ist, können Clients seine "QueryService"-Methode verwenden, um eine Schnittstelle IAccessibleEx anzufordern. Weitere Informationen finden Sie unter [IAccessibleEx verwenden, von einem Client](https://msdn.microsoft.com/library/windows/desktop/dd561924.aspx). Ab .NET Framework 4.7.1 IServiceProvider und [IAccessibleEx](https://msdn.microsoft.com/library/windows/desktop/dd561898.aspx) (falls zutreffend) für WinForms Eingabehilfen-Objekte verfügbar sind. .NET Framework 4.7.1 fügt Unterstützung für die folgenden UI-Automatisierung Muster und Eigenschaften hinzu:<ul><li>Die <code>T:System.Windows.Forms.ToolStripSplitButton</code> und <code>T:System.Windows.Forms.ComboBox</code> Steuerelemente unterstützen das [Expand/Collapse Muster](~/docs/framework/ui-automation/implementing-the-ui-automation-expandcollapse-control-pattern.md).</li><li>Die <code>T:System.Windows.Forms.ToolStripMenuItem</code> Steuerelement verfügt über eine [ControlType](~/docs/framework/ui-automation/ui-automation-support-for-the-menubar-control-type.md) Eigenschaftswert <xref:System.Windows.Automation.ControlType.MenuItem?displayProperty=nameWithType>.</li><li>Die <code>T:System.Windows.Forms.ToolStripItem</code> -Steuerelement unterstützt die [Namen](xref:System.Windows.Automation.AutomationElement.NameProperty) Eigenschaft und [Expand/Collapse Muster](~/docs/framework/ui-automation/implementing-the-ui-automation-expandcollapse-control-pattern.md).</li><li>Die <code>T:System.Windows.Forms.ToolStripDropDownItem</code> -Steuerelement unterstützt <xref:System.Windows.Forms.AccessibleEvents> StateChange und NameChange angibt, wenn Dropdown erweitert oder reduziert ist.</li><li>Die <code>T:System.Windows.Forms.ToolStripDropDownButton</code> Steuerelement verfügt über eine [ControlType](~/docs/framework/ui-automation/ui-automation-support-for-the-menubar-control-type.md) Eigenschaftswert <xref:System.Windows.Automation.ControlType.MenuItem?displayProperty=nameWithType>.</li><li>Die <code>T:System.Windows.Forms.DataGridViewCheckBoxCell</code> -Steuerelement unterstützt die [Toggle-Muster](xref:System.Windows.Automation.TogglePattern).</li><li>Die <code>T:System.Windows.Forms.NumericUpDown</code> und <code>T:System.Windows.Forms.DomainUpDown</code> Steuerelemente unterstützen die [Namen](xref:System.Windows.Automation.AutomationElement.NameProperty) und haben eine [ControlType](~/docs/framework/ui-automation/ui-automation-support-for-the-spinner-control-type.md) von <xref:System.Windows.Automation.ControlType.Spinner?displayProperty=nameWithType>.</li></ul><strong>Verbesserungen an das Steuerelement PropertyGrid</strong>.NET Framework 4.7.1 fügt die folgenden Verbesserungen auf das Steuerelement PropertyBrowser:<ul><li>Die <strong>Details</strong> Schaltfläche im Dialogfeld "Fehler", der angezeigt wird, bei der Eingabe eines falschen Werts in der <code>T:System.Windows.Forms.PropertyGrid</code> -Steuerelement unterstützt die [Expand/Collapse Muster](~/docs/framework/ui-automation/implementing-the-ui-automation-expandcollapse-control-pattern.md), Status und die Änderung des Computernamens Benachrichtigungen, und ein [ControlType](~/docs/framework/ui-automation/ui-automation-support-for-the-menubar-control-type.md) Eigenschaft mit einem Wert von <xref:System.Windows.Automation.ControlType.MenuItem?displayProperty=nameWithType>.</li><li>Der Bereich der Meldung angezeigt, wenn die <strong>Details</strong> Schaltfläche des Fehlerdialogfelds wird erweitert, ist nun Tastatur zugegriffen werden kann und erlaubt Sprachausgabe, um den Inhalt der Fehlermeldung anzukündigen.</li><li>Die <xref:System.Windows.Forms.AccessibleRole> der Zeilen im <code>T:System.Windows.Forms.PropertyGrid</code> Steuerelement geändert haben &quot;Zeile&quot; auf &quot;Zelle&quot;. Die Zelle ordnet UIA ControlType &quot;DataItem&quot;, dadurch wird die Unterstützung der entsprechenden Tastenkombinationen und Sprachausgabe Ankündigungen.</li><li>Die <code>T:System.Windows.Forms.PropertyGrid</code> steuern, welche darstellen Header Elemente bei, Zeilen der <code>T:System.Windows.Forms.PropertyGrid</code> Steuerelement besitzt eine <code>P:System.Windows.Forms.PropertySort</code> -Eigenschaftensatz auf <code>F:System.Windows.Forms.PropertySory.Categorized</code> haben eine [ControlType](~/docs/framework/ui-automation/ui-automation-support-for-the-menubar-control-type.md) Eigenschaftswert <xref:System.Windows.Automation.ControlType.Button?displayProperty=nameWithType></li><li>Die <code>T:System.Windows.Forms.PropertyGrid</code> steuern, welche darstellen Header Elemente bei, Zeilen der <code>T:System.Windows.Forms.PropertyGrid</code> Steuerelement verfügt über eine <code>P:System.Windows.Forms.PropertySort</code> -Eigenschaftensatz auf <code>F:System.Windows.Forms.PropertySory.Categorized</code> unterstützen die [erweitern/reduzieren-Muster](~/docs/framework/ui-automation/implementing-the-ui-automation-expandcollapse-control-pattern.md).</li><li>Verbesserte Tastaturnavigation zwischen dem Raster und der Symbolleiste oben. Drücken &quot;mit Umschalttaste + Tab&quot; jetzt wählt den ersten Symbolleisten-Schaltfläche, statt die gesamte Symbolleiste</li><li><code>T:System.Windows.Forms.PropertyGrid</code> im Modus für hohe Kontraste angezeigten Steuerelemente werden jetzt ein Fokusrechteck um die Symbolleisten-Schaltfläche der entspricht gezeichnet, mit dem aktuellen <code>P:System.Windows.Forms.PropertySort</code> Eigenschaftswert.</li><li><code>T:System.Windows.Forms.PropertyGrid</code> Steuerelemente, die in den Modus für hohe Kontraste und mit einem <code>P:System.Windows.Forms.PropertySort</code> -Eigenschaftensatz auf <code>F:System.Windows.Forms.PropertySory.Categorized</code> jetzt zeigt den Hintergrund des kategorienheader in einer hochgradig kontrastreiche Farbe.</li><li><code>T:System.Windows.Forms.PropertyGrid</code> Steuerelemente besser Symbolleistenelemente mit dem Fokus und was darauf hindeuten, den aktuellen Wert der dass Symbolleistenelemente unterscheidet die <code>P:System.Windows.Forms.PropertySort</code> Eigenschaft. Diesen Fix besteht ein hoher Kontrast ändern und eine Änderung für Szenarien mit hohem Kontrast - nicht ab.</li><li><code>T:System.Windows.Forms.PropertyGrid</code> Steuern der Symbolleistenelemente, womit den aktuellen Wert der die <code>P:System.Windows.Forms.PropertySort</code> Eigenschaft unterstützt die [Toggle-Muster](xref:System.Windows.Automation.TogglePattern).</li><li>Verbesserte Sprachausgabe-Unterstützung für die Unterscheidung der ausgewählten Ausrichtung in die Auswahl einer Ausrichtung.</li><li>Wenn eine leere <code>T:System.Windows.Forms.PropertyGrid</code> Steuerelement in einem Formular angezeigt wird, erhält er nun den Fokus, in dem zuvor dies der Fall nicht wäre.</li></ul><strong>Verwendung von OS benutzerdefinierte Farben in Designs mit hohem Kontrast</strong><ul><li><code>T:System.Windows.Forms.Button</code> und <code>T:System.Windows.Forms.CheckBox</code> steuert mit <code>P:System.Windows.Forms.Control.FlatStyle</code> festgelegt <xref:System.Windows.Forms.FlatStyle.System?displayProperty=nameWithType>, Hierbei handelt es sich um das Standardformat, jetzt verwenden OS benutzerdefinierte Farben im Design "hoher Kontrast" beim aktiviert. Zuvor, Text- und Hintergrundfarben wurden nicht Vergleich und sind schwer zu lesen.</li><li><code>T:System.Windows.Forms.Button</code>, <code>T:System.Windows.Forms.CheckBox</code>, <code>T:System.Windows.Forms.RadioButton</code>, <code>T:System.Windows.Forms.Label</code>, <code>T:System.Windows.Forms.LinkLabel</code> und <code>T:System.Windows.Forms.GroupBox</code> mit<code>P:System.Windows.Forms.Control.Enabled</code> festgelegt <em>"false"</em>, verwendet eine schattierte Farbe zum Rendern von Text in Designs mit hohem Kontrast, was zu geringen Kontrast gegen die im Hintergrund. Verwenden Sie diese Steuerelemente &quot;deaktiviertem Text&quot; vom Betriebssystem definierte Farbe. Dieser Fix wendet auf Steuerelemente mit <code>P:System.Windows.Forms.Control.FlatStyle</code> -Eigenschaft auf einen Wert festgelegt wurde, außer <code>F:System.Windows.Forms.FlatStyle.System</code>. Die letztere Steuerelemente werden vom Betriebssystem gerendert.</li><li><code>T:System.Windows.Forms.DataGridView</code> jetzt rendert ein sichtbar Rechteck, um den Inhalt der Zelle, die gegenwärtig den Fokus besitzt. Früher war dies nicht in bestimmten Designs mit hohem Kontrast angezeigt.</li><li><code>T:System.Windows.Forms.ToolStripMenuItem</code> Steuerelemente mit einer <code>P:System.Windows.Forms.ToolStripItem.Enabled</code> -Eigenschaftensatz auf <em>"false"</em> jetzt verwenden die &quot;deaktiviertem Text&quot; vom Betriebssystem definierte Farbe.</li><li><code>T:System.Windows.Forms.ToolStripMenuItem</code> Steuerelemente mit einem <code>P:System.Windows.Forms.ToolStripItem.Checked</code> -Eigenschaftensatz auf <em>"true"</em> nun rendert das zugeordnete Häkchen in einem kontrastreiche Systemfarbe.  Zuvor die Häkchen-Farbe wurde nicht Vergleich ausreichend und in den Designs mit hohem Kontrast nicht sichtbar.</li></ul>Hinweis: Windows 10 wurde Werte für einige hoher Kontrast Systemfarben geändert. Windows Forms-Framework basiert auf der Win32-Framework. Optimale Ergebnisse zu erzielen führen Sie auf die neueste Version von Windows, und entscheiden Sie sich mit den aktuellen OS-Änderungen, indem Sie eine Datei "app.manifest" in einer testanwendung hinzufügen und die auskommentierung des folgenden Codes:<pre><code>&lt;!-- Windows 10 --&gt;&#13;&#10;&lt;supportedOS Id=&quot;{8e0f7a12-bfb3-4fe8-b9a5-48fd50a15a9a}&quot; /&gt;&#13;&#10;</code></pre><strong>Verbesserte Tastaturnavigation</strong><ul><li>Wenn eine <code>T:System.Windows.Forms.ComboBox</code> -Steuerelement <code>P:System.Windows.Forms.ComboBox.DropDownStyle</code> festgelegt <code>F:System.Windows.Forms.DropDownStyle.DropDownList</code> und ist das erste Steuerelement auf der Registerkarte order auf dem Formular jetzt zeigt ein Fokusrechteck an, wenn das übergeordnete Formular mithilfe der Tastatur geöffnet wird. Vor dieser Änderung über den Tastaturfokus auf dieses Steuerelement war, aber ein Fokusindikator nicht gerendert wurde.</li></ul><strong>Verbesserte Unterstützung für die Sprachausgabe</strong><ul><li>Die <code>T:System.Windows.Forms.MonthCalendar</code> Steuerelement wurde Unterstützung für hilfstechnologien, die Zugriff auf das Steuerelement, einschließlich der Möglichkeit für die Sprachausgabe, lesen den Wert des Steuerelements, wenn zuvor nicht konnte hinzugefügt.</li><li>Die <code>T:System.Windows.Forms.CheckedListBox</code> Steuerelement benachrichtigt jetzt Sprachausgabe bei der <code>P:System.Windows.Forms.CheckState</code> -Eigenschaft geändert wurde. Zuvor Sprachausgabe hat keine Benachrichtigung erhalten, und Benutzer wäre daher nicht informiert den <code>P:System.Windows.Forms.CheckState</code> aktualisiert wurde.</li><li>Die <code>T:System.Windows.Forms.LinkLabel</code> -Steuerelements die Möglichkeit, benachrichtigt er Sprachausgabe des Texts der im Steuerelement geändert hat. Zuvor Sprachausgabe dieser Text zweimal angekündigt und Lesen &quot; &amp; &quot; Symbole als echte Text, obwohl sie nicht für Benutzer sichtbar sind. Der doppelte Text wurde aus der Sprachausgabe Ankündigungen entfernt sowie unnötige &quot; &amp; &quot; Symbole.</li><li>Die <code>T:System.Windows.Forms.DataGridViewCell</code> Steuerelementtypen jetzt ordnungsgemäß Bericht der schreibgeschützte Status Sprachausgabe und andere hilfstechnologien.</li><li>Die Sprachausgabe ist jetzt das Systemmenü des untergeordnete Fenster in lesen [Multiple Document Interface](~/docs/framework/winforms/advanced/multiple-document-interface-mdi-applications.md) Anwendungen.</li><li>Sprachausgabe ist jetzt lesen <code>T:System.Windows.Forms.ToolStripMenuItem</code> steuert mit einem <code>P:System.Windows.Forms.ToolStripItem.Enabled</code> -Eigenschaftensatz auf <em>"false"</em>. Zuvor konnte sich Sprachausgabe deaktivierten Menüelemente zum Lesen des Inhalts zu konzentrieren.</li></ul>|
|Bereich|Hauptversion|
|Version|4.7.1|
|Typ|Neuzuweisung|
|Betroffene APIs|<ul><li><xref:System.Windows.Forms.ToolStripDropDownButton.CreateAccessibilityInstance?displayProperty=nameWithType></li><li><xref:System.Windows.Forms.DomainUpDown.DomainUpDownAccessibleObject.Name?displayProperty=nameWithType></li><li>[MonthCalendar.AccessibilityObject](xref:System.Windows.Forms.Control.AccessibilityObject)</li></ul>|

